"use strict";(self["webpackChunkkube_manage_web"]=self["webpackChunkkube_manage_web"]||[]).push([[701],{9701:function(e,a,t){t.r(a),t.d(a,{default:function(){return C}});var s=t(3396),n=t(7139);const l={class:"namespace"},i=(0,s.Uk)("创建"),m=(0,s.Uk)("搜索"),p=(0,s.Uk)("刷新"),r={class:"namespace-body-namespacename"},c=(0,s.Uk)("YAML"),o=(0,s.Uk)("删除"),d={class:"dialog-footer"},u=(0,s.Uk)("取 消"),g=(0,s.Uk)("更 新");function h(e,a,t,h,w,f){const _=(0,s.up)("el-button"),b=(0,s.up)("el-col"),D=(0,s.up)("el-input"),y=(0,s.up)("el-row"),N=(0,s.up)("el-card"),C=(0,s.up)("el-table-column"),W=(0,s.up)("el-tag"),k=(0,s.up)("el-popover"),z=(0,s.up)("el-table"),v=(0,s.up)("el-pagination"),x=(0,s.up)("codemirror"),T=(0,s.up)("el-dialog"),U=(0,s.Q2)("loading");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{span:24},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(N,{class:"namespace-head-card",shadow:"never","body-style":{padding:"10px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{span:2},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(_,{disabled:"",style:{"border-radius":"2px"},icon:"Edit",type:"primary"},{default:(0,s.w5)((()=>[i])),_:1})])])),_:1}),(0,s.Wm)(b,{span:6},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(D,{class:"namespace-head-search",clearable:"",placeholder:"请输入",modelValue:w.searchInput,"onUpdate:modelValue":a[0]||(a[0]=e=>w.searchInput=e)},null,8,["modelValue"]),(0,s.Wm)(_,{style:{"border-radius":"2px"},icon:"Search",type:"primary",plain:"",onClick:a[1]||(a[1]=e=>f.getNamespaces())},{default:(0,s.w5)((()=>[m])),_:1})])])),_:1}),(0,s.Wm)(b,{span:2,offset:14},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(_,{style:{"border-radius":"2px"},icon:"Refresh",plain:"",onClick:a[2]||(a[2]=e=>f.getNamespaces())},{default:(0,s.w5)((()=>[p])),_:1})])])),_:1})])),_:1})])),_:1})])])),_:1}),(0,s.Wm)(b,{span:24},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(N,{class:"namespace-body-card",shadow:"never","body-style":{padding:"5px"}},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(z,{style:{width:"100%","font-size":"12px","margin-bottom":"10px"},data:w.namespaceList},{default:(0,s.w5)((()=>[(0,s.Wm)(C,{width:"20"}),(0,s.Wm)(C,{align:"left",label:"Namespace名"},{default:(0,s.w5)((e=>[(0,s._)("a",r,(0,n.zw)(e.row.metadata.name),1)])),_:1}),(0,s.Wm)(C,{align:"center",label:"标签","min-width":"120"},{default:(0,s.w5)((e=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.row.metadata.labels,((e,a)=>((0,s.wg)(),(0,s.iD)("div",{key:a},[(0,s.Wm)(k,{placement:"right",width:200,trigger:"hover",content:a+":"+e},{reference:(0,s.w5)((()=>[(0,s.Wm)(W,{style:{"margin-bottom":"5px"},type:"warning"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(f.ellipsis(a+":"+e)),1)])),_:2},1024)])),_:2},1032,["content"])])))),128))])),_:1}),(0,s.Wm)(C,{align:"center",prop:"status.phase",label:"状态"},{default:(0,s.w5)((e=>[(0,s._)("span",{class:(0,n.C_)(["Active"===e.row.status.phase?"success-status":"error-status"])},(0,n.zw)(e.row.status.phase),3)])),_:1}),(0,s.Wm)(C,{align:"center","min-width":"100",label:"创建时间"},{default:(0,s.w5)((e=>[(0,s.Wm)(W,{type:"info"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(f.timeTrans(e.row.metadata.creationTimestamp)),1)])),_:2},1024)])),_:1}),(0,s.Wm)(C,{align:"center",label:"操作","min-width":"120"},{default:(0,s.w5)((e=>[(0,s.Wm)(_,{size:"small",style:{"border-radius":"2px"},icon:"Edit",type:"primary",plain:"",onClick:a=>f.getNamespaceDetail(e)},{default:(0,s.w5)((()=>[c])),_:2},1032,["onClick"]),(0,s.Wm)(_,{size:"small",style:{"border-radius":"2px"},icon:"Delete",type:"danger",onClick:a=>f.handleConfirm(e,"删除",f.delNamespace)},{default:(0,s.w5)((()=>[o])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[U,w.appLoading]]),(0,s.Wm)(v,{class:"namespace-body-pagination",background:"",onSizeChange:f.handleSizeChange,onCurrentChange:f.handleCurrentChange,"current-page":w.currentPage,"page-sizes":w.pagesizeList,"page-size":w.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:w.namespaceTotal},null,8,["onSizeChange","onCurrentChange","current-page","page-sizes","page-size","total"])])),_:1})])])),_:1})])),_:1}),(0,s.Wm)(T,{title:"YAML信息",modelValue:w.yamlDialog,"onUpdate:modelValue":a[5]||(a[5]=e=>w.yamlDialog=e),width:"45%",top:"5%"},{footer:(0,s.w5)((()=>[(0,s._)("span",d,[(0,s.Wm)(_,{onClick:a[3]||(a[3]=e=>w.yamlDialog=!1)},{default:(0,s.w5)((()=>[u])),_:1}),(0,s.Wm)(_,{disabled:"",type:"primary",onClick:a[4]||(a[4]=e=>f.updateNamespace())},{default:(0,s.w5)((()=>[g])),_:1})])])),default:(0,s.w5)((()=>[(0,s.Wm)(x,{value:w.contentYaml,border:"",options:w.cmOptions,height:"500",style:{"font-size":"14px"},onChange:f.onChange},null,8,["value","options","onChange"])])),_:1},8,["modelValue"])])}var w=t(7973),f=t(5959),_=t(1391),b=t(3794),D={data(){return{cmOptions:w.Z.cmOptions,contentYaml:"",currentPage:1,pagesize:10,pagesizeList:[10,20,30],searchInput:"",namespaceValue:"default",namespaceList:[],appLoading:!1,namespaceTotal:0,getNamespacesData:{params:{filter_name:"",namespace:"",page:1,limit:10}},namespaceDetail:{},getNamespaceDetailData:{params:{name:"",namespace:""}},yamlDialog:!1,updateNamespaceData:{params:{namespace:"",content:""}},delNamespaceData:{params:{name:"",namespace:""}}}},methods:{transYaml(e){return _.stringify(e)},transObj(e){return f.ZP.load(e)},onChange(e){this.contentYaml=e},handleSizeChange(e){this.pagesize=e,this.getNamespaces()},handleCurrentChange(e){this.currentPage=e,this.getNamespaces()},handleClose(e){this.$confirm("确认关闭？").then((()=>{e()})).catch((()=>{}))},ellipsis(e){return e.length>15?e.substring(0,15)+"...":e},timeTrans(e){let a=new Date(new Date(e).getTime()+288e5);return a=a.toJSON(),a=a.substring(0,19).replace("T"," "),a},specTrans(e){if(-1==e.indexOf("Ki"))return e;let a=e.slice(0,-2)/1024/1024;return a.toFixed(0)},getNamespaces(){this.getNamespacesData.params.filter_name=this.searchInput,this.getNamespacesData.params.limit=this.pagesize,this.getNamespacesData.params.page=this.currentPage,(0,b.I1)(this.getNamespacesData.params).then((e=>{this.namespaceList=e.data.items,this.namespaceTotal=e.data.total})).catch((e=>{this.$message.error({message:e.msg})}))},getNamespaceDetail(e){this.getNamespaceDetailData.params.name=e.row.metadata.name,this.getNamespaceDetailData.params.namespace=this.namespaceValue,(0,b.Mc)(this.getNamespaceDetailData.params).then((e=>{this.namespaceDetail=e.data,this.contentYaml=this.transYaml(this.namespaceDetail),this.yamlDialog=!0})).catch((e=>{this.$message.error({message:e.msg})}))},updateNamespace(){let e=JSON.stringify(this.transObj(this.contentYaml));this.updateNamespaceData.params.namespace=this.namespaceValue,this.updateNamespaceData.params.content=e,(0,b.gR)(this.updateNamespaceData.params).then((e=>{this.$message.success({message:e.msg})})).catch((e=>{this.$message.error({message:e.msg})})),this.yamlDialog=!1},delNamespace(e){this.delNamespaceData.params.name=e.row.metadata.name,this.delNamespaceData.params.namespace=this.namespaceValue,(0,b.Wd)(this.delNamespaceData.params).then((e=>{this.getNamespaces(),this.$message.success({message:e.msg})})).catch((e=>{this.$message.error({message:e.msg})}))},handleConfirm(e,a,t){this.confirmContent="确认继续 "+a+" 操作吗？",this.$confirm(this.confirmContent,"提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{t(e)})).catch((()=>{this.$message.info({message:"已取消操作"})}))}},beforeMount(){this.getNamespaces()}},y=t(89);const N=(0,y.Z)(D,[["render",h],["__scopeId","data-v-bb972e4a"]]);var C=N}}]);
//# sourceMappingURL=701.1e1f5520.js.map
"use strict";(self["webpackChunkkube_manage_web"]=self["webpackChunkkube_manage_web"]||[]).push([[42],{2042:function(e,l,a){a.r(l),a.d(l,{default:function(){return O}});var t=a(3396),u=a(7139),n=a(4870),i=a(4471);function o(e){return(0,i.Z)({url:"/api/operation/get_operations",method:"get",params:e})}function r(e){return(0,i.Z)({url:`/api/operation/${e}/delete_operation`,method:"delete"})}function s(e){return(0,i.Z)({url:"/api/operation/delete_operations",method:"post",data:e})}function p(e,l){var a=new Date(e).Format("yyyy-MM-dd hh:mm:ss");return l&&(a=new Date(e).Format(l)),a.toLocaleString()}Date.prototype.Format=function(e){var l={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),l)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?l[a]:("00"+l[a]).substr((""+l[a]).length)));return e};const d=e=>{if(null!==e&&""!==e){var l=new Date(e);return p(l,"yyyy-MM-dd hh:mm:ss")}return""};var m=a(7178);const c={class:"gva-search-box"},w=(0,t.Uk)("查询"),v=(0,t.Uk)("重置"),g={class:"gva-table-box mt-2"},h=(0,t._)("p",null,"确定要删除吗？",-1),f={style:{"text-align":"right","margin-top":"8px"}},_=(0,t.Uk)("取消"),y=(0,t.Uk)("确定"),b=(0,t.Uk)("删除"),k={class:"popover-box"},W={key:1},z={class:"popover-box"},U={key:1},C=(0,t._)("p",null,"确定要删除吗？",-1),V={style:{"text-align":"right","margin-top":"8px"}},x=(0,t.Uk)("取消"),S=(0,t.Uk)("确定"),H=(0,t.Uk)("删除"),D={class:"gva-pagination mt-2"},E={name:"SysOperationRecord"};var M=Object.assign(E,{setup(e){const l=(0,n.iH)(!0),a=(0,n.iH)(1),i=(0,n.iH)(0),p=(0,n.iH)(10),E=(0,n.iH)([]),M=(0,n.iH)({}),j=(0,n.iH)(["GET","POST","PUT","DELETE","OPTIONS"]),O=()=>{M.value={},F()},R=()=>{a.value=1,p.value=10,""===M.value.status&&(M.value.status=null),F()},T=e=>{p.value=e,F()},$=e=>{a.value=e,F()},F=async()=>{l.value=!0;const e=await o({page:a.value,pageSize:p.value,...M.value});e&&(E.value=e.data.list,i.value=e.data.total,a.value=e.data.page,p.value=e.data.pageSize,l.value=!1)};F();const N=(0,n.iH)(!1),P=(0,n.iH)([]),Z=e=>{P.value=e},I=async()=>{const e=[];P.value&&P.value.forEach((l=>{e.push(l.id)}));const l=await s({ids:e});l&&((0,m.z8)({type:"success",message:"删除成功"}),E.value.length===e.length&&a.value>1&&a.value--,N.value=!1,F())},L=async e=>{e.visible=!1;const l=await r(e.id);l&&((0,m.z8)({type:"success",message:"删除成功"}),1===E.value.length&&a.value>1&&a.value--,F())},Y=e=>{try{return JSON.parse(e)}catch(l){return e}};return(e,o)=>{const r=(0,t.up)("el-option"),s=(0,t.up)("el-select"),m=(0,t.up)("el-form-item"),F=(0,t.up)("el-input"),q=(0,t.up)("el-button"),G=(0,t.up)("el-form"),J=(0,t.up)("el-card"),K=(0,t.up)("el-popover"),Q=(0,t.up)("el-table-column"),A=(0,t.up)("el-tag"),B=(0,t.up)("warning"),X=(0,t.up)("el-icon"),ee=(0,t.up)("el-table"),le=(0,t.up)("el-pagination"),ae=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t._)("div",c,[(0,t.Wm)(J,null,{default:(0,t.w5)((()=>[(0,t.Wm)(G,{inline:!0,model:M.value},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"请求方法"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:M.value.method,"onUpdate:modelValue":o[0]||(o[0]=e=>M.value.method=e),placeholder:"请输入请求方法"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(j.value,((e,l)=>((0,t.wg)(),(0,t.j4)(r,{key:l,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(m,{label:"请求路径"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{modelValue:M.value.path,"onUpdate:modelValue":o[1]||(o[1]=e=>M.value.path=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(m,{label:"结果状态码"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{modelValue:M.value.status,"onUpdate:modelValue":o[2]||(o[2]=e=>M.value.status=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{size:"small",type:"primary",icon:"search",onClick:R},{default:(0,t.w5)((()=>[w])),_:1}),(0,t.Wm)(q,{size:"small",icon:"refresh",onClick:O},{default:(0,t.w5)((()=>[v])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})]),(0,t._)("div",g,[(0,t.Wm)(J,null,{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(K,{modelValue:N.value,"onUpdate:modelValue":o[5]||(o[5]=e=>N.value=e),placement:"top",width:"160"},{reference:(0,t.w5)((()=>[(0,t.Wm)(q,{icon:"delete",size:"small",style:{"margin-left":"10px"},disabled:!P.value.length,onClick:o[4]||(o[4]=e=>N.value=!0)},{default:(0,t.w5)((()=>[b])),_:1},8,["disabled"])])),default:(0,t.w5)((()=>[h,(0,t._)("div",f,[(0,t.Wm)(q,{size:"small",type:"primary",link:"",onClick:o[3]||(o[3]=e=>N.value=!1)},{default:(0,t.w5)((()=>[_])),_:1}),(0,t.Wm)(q,{size:"small",type:"primary",onClick:I},{default:(0,t.w5)((()=>[y])),_:1})])])),_:1},8,["modelValue"])]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(ee,{ref:"multipleTable",data:E.value,style:{width:"100%"},"tooltip-effect":"dark","row-key":"id",onSelectionChange:Z},{default:(0,t.w5)((()=>[(0,t.Wm)(Q,{align:"left",type:"selection",width:"55"}),(0,t.Wm)(Q,{align:"center",label:"操作人",width:"200"},{default:(0,t.w5)((e=>[(0,t._)("div",null,(0,u.zw)(e.row.user.userName)+"("+(0,u.zw)(e.row.user.nickName)+") ",1)])),_:1}),(0,t.Wm)(Q,{align:"center",label:"创建时间",width:"180"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,u.zw)((0,n.SU)(d)(e.row.created_at)),1)])),_:1}),(0,t.Wm)(Q,{align:"center",label:"状态码",prop:"status",width:"120"},{default:(0,t.w5)((e=>[(0,t._)("div",null,[(0,t.Wm)(A,{type:"success"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(e.row.status),1)])),_:2},1024)])])),_:1}),(0,t.Wm)(Q,{align:"left",label:"请求IP",prop:"ip",width:"120"}),(0,t.Wm)(Q,{align:"center",label:"请求方法",prop:"method",width:"120"}),(0,t.Wm)(Q,{align:"center",label:"请求路径",prop:"path",width:"500"}),(0,t.Wm)(Q,{align:"left",label:"请求",prop:"path",width:"80"},{default:(0,t.w5)((e=>[(0,t._)("div",null,[e.row.body?((0,t.wg)(),(0,t.j4)(K,{key:0,placement:"left-start",trigger:"click"},{reference:(0,t.w5)((()=>[(0,t.Wm)(X,{style:{cursor:"pointer"}},{default:(0,t.w5)((()=>[(0,t.Wm)(B)])),_:1})])),default:(0,t.w5)((()=>[(0,t._)("div",k,[(0,t._)("pre",null,(0,u.zw)(Y(e.row.body)),1)])])),_:2},1024)):((0,t.wg)(),(0,t.iD)("span",W,"无"))])])),_:1}),(0,t.Wm)(Q,{align:"left",label:"响应",prop:"path",width:"80"},{default:(0,t.w5)((e=>[(0,t._)("div",null,[e.row.resp?((0,t.wg)(),(0,t.j4)(K,{key:0,placement:"left-start",trigger:"click"},{reference:(0,t.w5)((()=>[(0,t.Wm)(X,{style:{cursor:"pointer"}},{default:(0,t.w5)((()=>[(0,t.Wm)(B)])),_:1})])),default:(0,t.w5)((()=>[(0,t._)("div",z,[(0,t._)("pre",null,(0,u.zw)(Y(e.row.resp)),1)])])),_:2},1024)):((0,t.wg)(),(0,t.iD)("span",U,"无"))])])),_:1}),(0,t.Wm)(Q,{align:"left",label:"操作"},{default:(0,t.w5)((e=>[(0,t.Wm)(K,{modelValue:e.row.visible,"onUpdate:modelValue":l=>e.row.visible=l,placement:"top",width:"160"},{reference:(0,t.w5)((()=>[(0,t.Wm)(q,{icon:"delete",size:"small",type:"primary",link:"",onClick:l=>e.row.visible=!0},{default:(0,t.w5)((()=>[H])),_:2},1032,["onClick"])])),default:(0,t.w5)((()=>[C,(0,t._)("div",V,[(0,t.Wm)(q,{size:"small",type:"primary",link:"",onClick:l=>e.row.visible=!1},{default:(0,t.w5)((()=>[x])),_:2},1032,["onClick"]),(0,t.Wm)(q,{size:"small",type:"primary",onClick:l=>L(e.row)},{default:(0,t.w5)((()=>[S])),_:2},1032,["onClick"])])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"])),[[ae,l.value]]),(0,t._)("div",D,[(0,t.Wm)(le,{"current-page":a.value,"page-size":p.value,"page-sizes":[10,30,50,100],total:i.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:$,onSizeChange:T},null,8,["current-page","page-size","total"])])])),_:1})])])}}});const j=M;var O=j}}]);
//# sourceMappingURL=42.48f7812d.js.map
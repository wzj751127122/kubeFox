"use strict";(self["webpackChunkkube_manage_web"]=self["webpackChunkkube_manage_web"]||[]).push([[248],{248:function(e,a,l){l.r(a),l.d(a,{default:function(){return T}});var r=l(3396),t=l(7139);const o=e=>((0,r.dD)("data-v-9121f74c"),e=e(),(0,r.Cn)(),e),s={class:"workflow"},n=o((()=>(0,r._)("span",null,"命名空间: ",-1))),i=(0,r.Uk)("刷新"),d=(0,r.Uk)("创建工作流"),c=(0,r.Uk)("搜索"),m={class:"workflow-body-workflowname"},w=(0,r.Uk)("详情"),p=(0,r.Uk)("删除"),u=o((()=>(0,r._)("h4",null,"创建Workflow-步骤1",-1))),f=(0,r.Uk)("ClusterIP"),h=(0,r.Uk)("NodePort"),W=(0,r.Uk)("Ingress"),k=(0,r.Uk)("取消"),g=(0,r.Uk)("下一步"),_=o((()=>(0,r._)("h4",null,"创建Workflow-步骤2",-1))),b=o((()=>(0,r._)("h4",{style:{"margin-bottom":"10px"}},"Deployment",-1))),y=(0,r.Uk)("取消"),V=(0,r.Uk)("下一步"),x=o((()=>(0,r._)("h4",null,"创建Workflow-步骤2",-1))),D=o((()=>(0,r._)("h4",{style:{"margin-bottom":"10px"}},"Service",-1))),I={key:2,style:{"margin-bottom":"10px"}},v=(0,r.Uk)("取消"),C=(0,r.Uk)("立即创建");function U(e,a,l,o,U,z){const q=(0,r.up)("el-option"),P=(0,r.up)("el-select"),L=(0,r.up)("el-col"),N=(0,r.up)("el-button"),S=(0,r.up)("el-row"),j=(0,r.up)("el-card"),$=(0,r.up)("el-step"),T=(0,r.up)("el-steps"),F=(0,r.up)("el-input"),E=(0,r.up)("el-table-column"),Z=(0,r.up)("el-tag"),G=(0,r.up)("el-table"),R=(0,r.up)("el-pagination"),M=(0,r.up)("el-radio"),A=(0,r.up)("el-form-item"),B=(0,r.up)("el-form"),H=(0,r.up)("el-drawer"),J=(0,r.up)("el-input-number"),K=(0,r.up)("WarningFilled"),O=(0,r.up)("el-icon"),Y=(0,r.up)("el-popover"),Q=(0,r.up)("el-switch"),X=(0,r.up)("el-divider"),ee=(0,r.Q2)("loading");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r.Wm)(S,null,{default:(0,r.w5)((()=>[(0,r.Wm)(L,{span:24},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r.Wm)(j,{class:"workflow-head-card",shadow:"never","body-style":{padding:"10px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(S,null,{default:(0,r.w5)((()=>[(0,r.Wm)(L,{span:6},{default:(0,r.w5)((()=>[(0,r._)("div",null,[n,(0,r.Wm)(P,{modelValue:U.namespaceValue,"onUpdate:modelValue":a[0]||(a[0]=e=>U.namespaceValue=e),filterable:"",placeholder:"请选择"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(U.namespaceList,((e,a)=>((0,r.wg)(),(0,r.j4)(q,{key:a,label:e.metadata.name,value:e.metadata.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1}),(0,r.Wm)(L,{span:2,offset:16},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r.Wm)(N,{style:{"border-radius":"2px"},icon:"Refresh",plain:"",onClick:a[1]||(a[1]=e=>z.getWorkflows())},{default:(0,r.w5)((()=>[i])),_:1})])])),_:1})])),_:1})])),_:1})])])),_:1}),(0,r.Wm)(L,{span:24},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r.Wm)(j,{class:"workflow-head-card",shadow:"never","body-style":{padding:"30px 10px 20px 10px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(T,{active:U.active,"align-center":"","finish-status":"success"},{default:(0,r.w5)((()=>[(0,r.Wm)($,{title:"步骤1",description:"选择工作流类型, ClusterIP NodePort Workflow"}),(0,r.Wm)($,{title:"步骤2",description:"填写Deployment Workflow Workflow表单"}),(0,r.Wm)($,{title:"步骤3",description:"创建Deployment Workflow Workflow"})])),_:1},8,["active"])])),_:1})])])),_:1}),(0,r.Wm)(L,{span:24},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r.Wm)(j,{class:"workflow-head-card",shadow:"never","body-style":{padding:"10px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(S,null,{default:(0,r.w5)((()=>[(0,r.Wm)(L,{span:3},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r.wy)(((0,r.wg)(),(0,r.j4)(N,{style:{"border-radius":"2px"},icon:"Edit",type:"primary",onClick:a[2]||(a[2]=e=>U.createWorkflowDrawerIndex1=!0)},{default:(0,r.w5)((()=>[d])),_:1})),[[ee,U.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])])])),_:1}),(0,r.Wm)(L,{span:6},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r.Wm)(F,{class:"workflow-head-search",clearable:"",placeholder:"请输入",modelValue:U.searchInput,"onUpdate:modelValue":a[3]||(a[3]=e=>U.searchInput=e)},null,8,["modelValue"]),(0,r.Wm)(N,{style:{"border-radius":"2px"},icon:"Search",type:"primary",plain:"",onClick:a[4]||(a[4]=e=>z.getWorkflows())},{default:(0,r.w5)((()=>[c])),_:1})])])),_:1})])),_:1})])),_:1})])])),_:1}),(0,r.Wm)(L,{span:24},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r.Wm)(j,{class:"workflow-body-card",shadow:"never","body-style":{padding:"5px"}},{default:(0,r.w5)((()=>[(0,r.wy)(((0,r.wg)(),(0,r.j4)(G,{style:{width:"100%","font-size":"12px","margin-bottom":"10px"},data:U.workflowList},{default:(0,r.w5)((()=>[(0,r.Wm)(E,{width:"20"}),(0,r.Wm)(E,{"min-width":"50",align:"left",label:"ID",prop:"id"}),(0,r.Wm)(E,{"min-width":"100",label:"Workflow名"},{default:(0,r.w5)((e=>[(0,r._)("a",m,(0,t.zw)(e.row.name),1)])),_:1}),(0,r.Wm)(E,{label:"类型",prop:"type"},{default:(0,r.w5)((e=>[(0,r.Wm)(Z,{type:"warning"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(e.row.service_type),1)])),_:2},1024)])),_:1}),(0,r.Wm)(E,{label:"实例数",prop:"replicas"}),(0,r.Wm)(E,{"min-width":"100",label:"deployment",prop:"deployment"}),(0,r.Wm)(E,{"min-width":"150",label:"service",prop:"service"}),(0,r.Wm)(E,{"min-width":"150",label:"ingress",prop:"ingress"}),(0,r.Wm)(E,{align:"center","min-width":"150",label:"创建时间"},{default:(0,r.w5)((e=>[(0,r.Wm)(Z,{type:"info"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,t.zw)(z.timeTransNot8(e.row.created_at)),1)])),_:2},1024)])),_:1}),(0,r.Wm)(E,{align:"center",label:"操作",width:"200"},{default:(0,r.w5)((a=>[(0,r.Wm)(N,{size:"small",disabled:"",style:{"border-radius":"2px"},icon:"Edit",type:"primary",plain:"",onClick:l=>e.getWorkflowDetail(a)},{default:(0,r.w5)((()=>[w])),_:2},1032,["onClick"]),(0,r.Wm)(N,{size:"small",style:{"border-radius":"2px"},icon:"Delete",type:"danger",onClick:e=>z.handleConfirm(a,"删除",z.delWorkflow)},{default:(0,r.w5)((()=>[p])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ee,U.appLoading]]),(0,r.Wm)(R,{class:"workflow-body-pagination",background:"",onSizeChange:z.handleSizeChange,onCurrentChange:z.handleCurrentChange,"current-page":U.currentPage,"page-sizes":U.pagesizeList,"page-size":U.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:U.workflowTotal},null,8,["onSizeChange","onCurrentChange","current-page","page-sizes","page-size","total"])])),_:1})])])),_:1})])),_:1}),(0,r.Wm)(H,{modelValue:U.createWorkflowDrawerIndex1,"onUpdate:modelValue":a[10]||(a[10]=e=>U.createWorkflowDrawerIndex1=e),direction:U.direction,"before-close":z.handleClose},{title:(0,r.w5)((()=>[u])),default:(0,r.w5)((()=>[(0,r.Wm)(S,{type:"flex",justify:"center"},{default:(0,r.w5)((()=>[(0,r.Wm)(L,{span:20},{default:(0,r.w5)((()=>[(0,r.Wm)(B,{"label-width":"80px"},{default:(0,r.w5)((()=>[(0,r.Wm)(A,{class:"workflow-create-form",label:"类型",prop:"name"},{default:(0,r.w5)((()=>[(0,r.Wm)(M,{modelValue:U.createWorkflow.type,"onUpdate:modelValue":a[5]||(a[5]=e=>U.createWorkflow.type=e),label:"ClusterIP"},{default:(0,r.w5)((()=>[f])),_:1},8,["modelValue"]),(0,r.Wm)(M,{modelValue:U.createWorkflow.type,"onUpdate:modelValue":a[6]||(a[6]=e=>U.createWorkflow.type=e),label:"NodePort"},{default:(0,r.w5)((()=>[h])),_:1},8,["modelValue"]),(0,r.Wm)(M,{modelValue:U.createWorkflow.type,"onUpdate:modelValue":a[7]||(a[7]=e=>U.createWorkflow.type=e),label:"Ingress"},{default:(0,r.w5)((()=>[W])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),footer:(0,r.w5)((()=>[(0,r.Wm)(N,{onClick:a[8]||(a[8]=e=>z.drawerCancel("createWorkflowDrawerIndex1"))},{default:(0,r.w5)((()=>[k])),_:1}),(0,r.Wm)(N,{type:"primary",onClick:a[9]||(a[9]=e=>z.workflowIndex1Next())},{default:(0,r.w5)((()=>[g])),_:1})])),_:1},8,["modelValue","direction","before-close"]),(0,r.Wm)(H,{modelValue:U.createWorkflowDrawerIndex2_1,"onUpdate:modelValue":a[22]||(a[22]=e=>U.createWorkflowDrawerIndex2_1=e),direction:U.direction,"before-close":z.handleClose},{title:(0,r.w5)((()=>[_])),default:(0,r.w5)((()=>[(0,r.Wm)(S,{type:"flex",justify:"center"},{default:(0,r.w5)((()=>[(0,r.Wm)(L,{span:20},{default:(0,r.w5)((()=>[(0,r.Wm)(B,{ref:"createWorkflow",rules:U.createWorkflowRules,model:U.createWorkflow,"label-width":"80px"},{default:(0,r.w5)((()=>[b,(0,r.Wm)(A,{class:"workflow-create-form",label:"名称",prop:"name"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.name,"onUpdate:modelValue":a[11]||(a[11]=e=>U.createWorkflow.name=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"命名空间",prop:"namespace"},{default:(0,r.w5)((()=>[(0,r.Wm)(P,{modelValue:U.createWorkflow.namespace,"onUpdate:modelValue":a[12]||(a[12]=e=>U.createWorkflow.namespace=e),filterable:"",placeholder:"请选择"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(U.namespaceList,((e,a)=>((0,r.wg)(),(0,r.j4)(q,{key:a,label:e.metadata.name,value:e.metadata.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"副本数",prop:"replicas"},{default:(0,r.w5)((()=>[(0,r.Wm)(J,{modelValue:U.createWorkflow.replicas,"onUpdate:modelValue":a[13]||(a[13]=e=>U.createWorkflow.replicas=e),min:1,max:10},null,8,["modelValue"]),(0,r.Wm)(Y,{placement:"top",width:100,trigger:"hover",content:"申请副本数上限为10个"},{reference:(0,r.w5)((()=>[(0,r.Wm)(O,{style:{width:"2em","font-size":"18px",color:"#4795EE"}},{default:(0,r.w5)((()=>[(0,r.Wm)(K)])),_:1})])),_:1})])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"镜像",prop:"image"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.image,"onUpdate:modelValue":a[14]||(a[14]=e=>U.createWorkflow.image=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"标签",prop:"label_str"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.label_str,"onUpdate:modelValue":a[15]||(a[15]=e=>U.createWorkflow.label_str=e),placeholder:"示例: project=ms,app=gateway"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"资源配额",prop:"resource"},{default:(0,r.w5)((()=>[(0,r.Wm)(P,{modelValue:U.createWorkflow.resource,"onUpdate:modelValue":a[16]||(a[16]=e=>U.createWorkflow.resource=e),placeholder:"请选择"},{default:(0,r.w5)((()=>[(0,r.Wm)(q,{value:"0.5/1",label:"0.5C1G"}),(0,r.Wm)(q,{value:"1/2",label:"1C2G"}),(0,r.Wm)(q,{value:"2/4",label:"2C4G"}),(0,r.Wm)(q,{value:"4/8",label:"4C8G"})])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"容器端口",prop:"container_port"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.container_port,"onUpdate:modelValue":a[17]||(a[17]=e=>U.createWorkflow.container_port=e),placeholder:"示例: 80"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"健康检查",prop:"health"},{default:(0,r.w5)((()=>[(0,r.Wm)(Q,{modelValue:U.createWorkflow.health_check,"onUpdate:modelValue":a[18]||(a[18]=e=>U.createWorkflow.health_check=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(A,{class:"workflow-create-form",label:"检查路径",prop:"healthPath"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.health_path,"onUpdate:modelValue":a[19]||(a[19]=e=>U.createWorkflow.health_path=e),placeholder:"示例: /health"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1})])),_:1})])),footer:(0,r.w5)((()=>[(0,r.Wm)(N,{onClick:a[20]||(a[20]=e=>z.drawerCancel("createWorkflowDrawerIndex2_1"))},{default:(0,r.w5)((()=>[y])),_:1}),(0,r.Wm)(N,{type:"primary",onClick:a[21]||(a[21]=e=>z.submitForm("createWorkflow",z.workflowIndex2_1Next))},{default:(0,r.w5)((()=>[V])),_:1})])),_:1},8,["modelValue","direction","before-close"]),(0,r.Wm)(H,{modelValue:U.createWorkflowDrawerIndex2_2,"onUpdate:modelValue":a[30]||(a[30]=e=>U.createWorkflowDrawerIndex2_2=e),direction:U.direction,"before-close":z.handleClose},{title:(0,r.w5)((()=>[x])),default:(0,r.w5)((()=>[(0,r.Wm)(S,{type:"flex",justify:"center"},{default:(0,r.w5)((()=>[(0,r.Wm)(L,{span:20},{default:(0,r.w5)((()=>[(0,r.Wm)(B,{ref:"createWorkflow",rules:U.createWorkflowRules,model:U.createWorkflow,"label-width":"80px"},{default:(0,r.w5)((()=>[D,(0,r.Wm)(A,{class:"service-create-form",label:"Service端口",prop:"port"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.port,"onUpdate:modelValue":a[23]||(a[23]=e=>U.createWorkflow.port=e),placeholder:"示例: 80"},null,8,["modelValue"])])),_:1}),"NodePort"==U.createWorkflow.type?((0,r.wg)(),(0,r.j4)(A,{key:0,class:"service-create-form",label:"NodePort",prop:"node_port"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.node_port,"onUpdate:modelValue":a[24]||(a[24]=e=>U.createWorkflow.node_port=e),placeholder:"示例: 30001"},null,8,["modelValue"])])),_:1})):(0,r.kq)("",!0),"Ingress"==U.createWorkflow.type?((0,r.wg)(),(0,r.j4)(X,{key:1})):(0,r.kq)("",!0),"Ingress"==U.createWorkflow.type?((0,r.wg)(),(0,r.iD)("h4",I,"Ingress")):(0,r.kq)("",!0),"Ingress"==U.createWorkflow.type?((0,r.wg)(),(0,r.j4)(A,{key:3,class:"deploy-create-form",label:"域名",prop:"host"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.host,"onUpdate:modelValue":a[25]||(a[25]=e=>U.createWorkflow.host=e),placeholder:"示例: www.example.com"},null,8,["modelValue"])])),_:1})):(0,r.kq)("",!0),"Ingress"==U.createWorkflow.type?((0,r.wg)(),(0,r.j4)(A,{key:4,class:"ingress-create-form",label:"Path",prop:"path"},{default:(0,r.w5)((()=>[(0,r.Wm)(F,{modelValue:U.createWorkflow.path,"onUpdate:modelValue":a[26]||(a[26]=e=>U.createWorkflow.path=e),placeholder:"示例: /abc"},null,8,["modelValue"])])),_:1})):(0,r.kq)("",!0),"Ingress"==U.createWorkflow.type?((0,r.wg)(),(0,r.j4)(A,{key:5,class:"deploy-create-form",label:"匹配类型",prop:"path_type"},{default:(0,r.w5)((()=>[(0,r.Wm)(P,{modelValue:U.createWorkflow.path_type,"onUpdate:modelValue":a[27]||(a[27]=e=>U.createWorkflow.path_type=e),placeholder:"请选择"},{default:(0,r.w5)((()=>[(0,r.Wm)(q,{value:"Prefix",label:"Prefix"}),(0,r.Wm)(q,{value:"Exact",label:"Exact"}),(0,r.Wm)(q,{value:"ImplementationSpecific",label:"ImplementationSpecific"})])),_:1},8,["modelValue"])])),_:1})):(0,r.kq)("",!0)])),_:1},8,["rules","model"])])),_:1})])),_:1})])),footer:(0,r.w5)((()=>[(0,r.Wm)(N,{onClick:a[28]||(a[28]=e=>z.drawerCancel("createWorkflowDrawerIndex2_2"))},{default:(0,r.w5)((()=>[v])),_:1}),(0,r.Wm)(N,{type:"primary",onClick:a[29]||(a[29]=e=>z.submitForm("createWorkflow",z.createWorkflowFunc))},{default:(0,r.w5)((()=>[C])),_:1})])),_:1},8,["modelValue","direction","before-close"])])}var z=l(3794),q=l(4471);function P(e){return(0,q.Z)({url:"/api/k8s/workflow/list",method:"get",params:e})}function L(e){return(0,q.Z)({url:"/api/k8s/workflow/del",method:"delete",params:e})}function N(e){return(0,q.Z)({url:"/api/k8s/workflow/create",method:"post",data:e})}var S={data(){return{active:0,createWorkflowDrawerIndex1:!1,createWorkflowDrawerIndex2_1:!1,createWorkflowDrawerIndex2_2:!1,currentPage:1,pagesize:10,pagesizeList:[10,20,30],searchInput:"",namespaceValue:"default",namespaceList:[],appLoading:!1,workflowList:[],workflowTotal:0,getWorkflowsData:{params:{name:"",namespace:"",page:"",limit:""}},fullscreenLoading:!1,direction:"rtl",createWorkflowDrawer:!1,createWorkflow:{name:"",namespace:"",deployment:"",replicas:1,image:"",resource:"",health_check:!1,health_path:"",label_str:"",label:{},container_port:"",type:"",port:"",node_port:"",host:"",path:"",path_type:""},createWorkflowData:{params:{}},createWorkflowRules:{name:[{required:!0,message:"请填写名称",trigger:"change"}],image:[{required:!0,message:"请填写镜像",trigger:"change"}],namespace:[{required:!0,message:"请选择命名空间",trigger:"change"}],resource:[{required:!0,message:"请选择配额",trigger:"change"}],label_str:[{required:!0,message:"请填写标签",trigger:"change"}],container_port:[{required:!0,message:"请填写容器端口",trigger:"change"}],type:[{required:!0,message:"请填写工作流类型",trigger:"change"}],port:[{required:!0,message:"请填写Workflow端口",trigger:"change"}],node_port:[{required:!0,message:"请填写NodePort",trigger:"change"}],host:[{required:!0,message:"请填写域名",trigger:"change"}],path:[{required:!0,message:"请填写路径",trigger:"change"}],path_type:[{required:!0,message:"你选择匹配类型",trigger:"change"}]},delWorkflowData:{params:{id:""}}}},methods:{handleSizeChange(e){this.pagesize=e,this.getWorkflows()},handleCurrentChange(e){this.currentPage=e,this.getWorkflows()},handleClose(e){this.$confirm("确认关闭？").then((()=>{e()})).catch((()=>{})),this.active=0},drawerCancel(e){switch(e){case"createWorkflowDrawerIndex1":this.createWorkflowDrawerIndex1=!1;break;case"createWorkflowDrawerIndex2_1":this.createWorkflowDrawerIndex2_1=!1;break;case"createWorkflowDrawerIndex2_2":this.createWorkflowDrawerIndex2_2=!1}this.active=0},ellipsis(e){return e.length>15?e.substring(0,15)+"...":e},timeTrans(e){let a=new Date(new Date(e).getTime()+288e5);return a=a.toJSON(),a=a.substring(0,19).replace("T"," "),a},timeTransNot8(e){let a=new Date(new Date(e).getTime()+288e5);return a=a.toJSON(),a=a.substring(0,19).replace("T"," "),a},getNamespaces(){(0,z.I1)().then((e=>{this.namespaceList=e.data.items})).catch((e=>{this.$message.error({message:e.msg})}))},getWorkflows(){this.appLoading=!0,this.getWorkflowsData.params.name=this.searchInput,this.getWorkflowsData.params.namespace=this.namespaceValue,this.getWorkflowsData.params.page=this.currentPage,this.getWorkflowsData.params.limit=this.pagesize,P(this.getWorkflowsData.params).then((e=>{this.workflowList=e.data.items,this.workflowTotal=e.data.total})).catch((e=>{this.$message.error({message:e.msg})})),this.appLoading=!1},delWorkflow(e){this.delWorkflowData.params.id=e.row.id,L(this.delWorkflowData.params).then((e=>{this.getWorkflows(),this.$message.success({message:e.msg})})).catch((e=>{this.$message.error({message:e.msg})}))},handleConfirm(e,a,l){this.confirmContent="确认继续 "+a+" 操作吗？",this.$confirm(this.confirmContent,"提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{l(e)})).catch((()=>{this.$message.info({message:"已取消操作"})}))},createWorkflowFunc(){let e=new RegExp("(^[A-Za-z]+=[A-Za-z0-9]+).*");if(!e.test(this.createWorkflow.label_str))return void this.$message.warning({message:"标签填写异常，请确认后重新填写"});this.fullscreenLoading=!0;let a,l,r=new Map,t=this.createWorkflow.label_str.split(",");t.forEach((e=>{let a=e.split("=");r[a[0]]=a[1]}));let o=this.createWorkflow.resource.split("/");if(a=o[0],l=o[1]+"Gi",this.createWorkflowData.params=this.createWorkflow,this.createWorkflowData.params.label=r,this.createWorkflowData.params.cpu=a,this.createWorkflowData.params.memory=l,this.createWorkflowData.params.container_port=parseInt(this.createWorkflow.container_port),this.createWorkflowData.params.port=parseInt(this.createWorkflow.port),this.createWorkflowData.params.node_port=parseInt(this.createWorkflow.node_port),this.createWorkflowData.params.deployment=this.createWorkflow.name,"Ingress"==this.createWorkflow.type){let e=new Map,a=[],l={path:this.createWorkflow.path,path_type:this.createWorkflow.path_type,service_name:this.createWorkflow.name,service_port:parseInt(this.createWorkflow.port)};a.push(l),e[this.createWorkflow.host]=a,this.createWorkflowData.params.hosts=e}N(this.createWorkflowData.params).then((e=>{this.$message.success({message:e.msg}),this.getWorkflows()})).catch((e=>{this.$message.error({message:e.msg})})),this.resetForm("createWorkflow"),this.createWorkflowDrawerIndex2_2=!1,this.active=3,this.fullscreenLoading=!1},resetForm(e){this.$refs[e].resetFields()},submitForm(e,a){this.$refs[e].validate((e=>{if(!e)return!1;a()}))},workflowIndex1Next(){this.createWorkflow.type?(this.createWorkflowDrawerIndex1=!1,this.createWorkflowDrawerIndex2_1=!0,this.active=1):this.$message.warning({message:"请选择工作流类型"})},workflowIndex2_1Next(){this.createWorkflowDrawerIndex2_1=!1,this.createWorkflowDrawerIndex2_2=!0}},watch:{namespaceValue:{handler(){localStorage.setItem("namespace",this.namespaceValue),this.currentPage=1,this.getWorkflows()}}},beforeMount(){void 0!==localStorage.getItem("namespace")&&null!==localStorage.getItem("namespace")&&(this.namespaceValue=localStorage.getItem("namespace")),this.getNamespaces(),this.getWorkflows()}},j=l(89);const $=(0,j.Z)(S,[["render",U],["__scopeId","data-v-9121f74c"]]);var T=$}}]);
//# sourceMappingURL=248.812f7b5f.js.map